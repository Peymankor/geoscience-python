

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Select columns with .filter method &mdash; Geoscience with Python 2019 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Load tabular data from csv" href="cleaning_column_names.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Geoscience with Python
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../additional/welcome.html">Welcome to Geoscience with Python!</a></li>
</ul>
<p class="caption"><span class="caption-text">Load CSV and clean column names :</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cleaning_column_names.html">Load tabular data from csv</a></li>
<li class="toctree-l1"><a class="reference internal" href="cleaning_column_names.html#Clean-column-names">Clean column names</a></li>
<li class="toctree-l1"><a class="reference internal" href="cleaning_column_names.html#Rename-column-names">Rename column names</a></li>
</ul>
<p class="caption"><span class="caption-text">Select columns and filter rows:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Select columns with <strong>.filter</strong> method</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Filter-the-dataframe">Filter the dataframe</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Filter-the-dataframe-with-.query-method">Filter the dataframe with <strong>.query</strong> method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Query-the-dataframe-by-multiple-conditions">Query the dataframe by multiple conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Query-the-dataframe-by-a-predefined-list.">Query the dataframe by a predefined list.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Sort-the-dataframe">Sort the dataframe</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Geoscience with Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Select columns with <strong>.filter</strong> method</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/select_and_query.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Select-columns-with-.filter-method">
<h1>Select columns with <strong>.filter</strong> method<a class="headerlink" href="#Select-columns-with-.filter-method" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>import pandas as pd

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>local_relative_path = &quot;./source/data_processed/wellbore_exploration_all_clean_names.csv&quot;
wellbore_exploration_all = pd.read_csv(local_relative_path)
wellbore_exploration_all.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>production_licence</th>
      <th>purpose</th>
      <th>status</th>
      <th>content</th>
      <th>well_type</th>
      <th>sub_sea</th>
      <th>entry_date</th>
      <th>...</th>
      <th>npdid_wellbore</th>
      <th>dsc_npdid_discovery</th>
      <th>npdid_field</th>
      <th>npdid_facility_drilling</th>
      <th>npdid_wellbore_reclass</th>
      <th>l_npdid_production_licence</th>
      <th>npdid_site_survey</th>
      <th>date_updated</th>
      <th>date_updated_max</th>
      <th>datesync_npd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>1/2-1</td>
      <td>Phillips Petroleum Norsk AS</td>
      <td>143</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>20.03.1989</td>
      <td>...</td>
      <td>1382</td>
      <td>43814.0</td>
      <td>3437650.0</td>
      <td>296245.0</td>
      <td>0</td>
      <td>21956.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1/2-2</td>
      <td>1/2-2</td>
      <td>Paladin Resources Norge AS</td>
      <td>143 CS</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL SHOWS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.12.2005</td>
      <td>...</td>
      <td>5192</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>278245.0</td>
      <td>0</td>
      <td>2424919.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1/3-1</td>
      <td>1/3-1</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>06.07.1968</td>
      <td>...</td>
      <td>154</td>
      <td>43820.0</td>
      <td>NaN</td>
      <td>288604.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1/3-2</td>
      <td>1/3-2</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>DRY</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.05.1969</td>
      <td>...</td>
      <td>165</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>288847.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1/3-3</td>
      <td>1/3-3</td>
      <td>Elf Petroleum Norge AS</td>
      <td>065</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>22.08.1982</td>
      <td>...</td>
      <td>87</td>
      <td>43826.0</td>
      <td>1028599.0</td>
      <td>288334.0</td>
      <td>0</td>
      <td>21316.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 87 columns</p>
</div></div>
</div>
<p>You select columns in a dataframe by using <strong>.filter method</strong> — a bit non-inuitive since we use it to select columns by a columns name, and we <strong>filter</strong> the columns by a condition by using <strong>.query</strong> method. It is what it is :)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(wellbore_exploration_all
  .filter(items=[&quot;wellbore_name&quot;, &quot;well_type&quot;])
)

wellbore_exploration_all.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>production_licence</th>
      <th>purpose</th>
      <th>status</th>
      <th>content</th>
      <th>well_type</th>
      <th>sub_sea</th>
      <th>entry_date</th>
      <th>...</th>
      <th>npdid_wellbore</th>
      <th>dsc_npdid_discovery</th>
      <th>npdid_field</th>
      <th>npdid_facility_drilling</th>
      <th>npdid_wellbore_reclass</th>
      <th>l_npdid_production_licence</th>
      <th>npdid_site_survey</th>
      <th>date_updated</th>
      <th>date_updated_max</th>
      <th>datesync_npd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>1/2-1</td>
      <td>Phillips Petroleum Norsk AS</td>
      <td>143</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>20.03.1989</td>
      <td>...</td>
      <td>1382</td>
      <td>43814.0</td>
      <td>3437650.0</td>
      <td>296245.0</td>
      <td>0</td>
      <td>21956.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1/2-2</td>
      <td>1/2-2</td>
      <td>Paladin Resources Norge AS</td>
      <td>143 CS</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL SHOWS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.12.2005</td>
      <td>...</td>
      <td>5192</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>278245.0</td>
      <td>0</td>
      <td>2424919.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1/3-1</td>
      <td>1/3-1</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>06.07.1968</td>
      <td>...</td>
      <td>154</td>
      <td>43820.0</td>
      <td>NaN</td>
      <td>288604.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1/3-2</td>
      <td>1/3-2</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>DRY</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.05.1969</td>
      <td>...</td>
      <td>165</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>288847.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1/3-3</td>
      <td>1/3-3</td>
      <td>Elf Petroleum Norge AS</td>
      <td>065</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>22.08.1982</td>
      <td>...</td>
      <td>87</td>
      <td>43826.0</td>
      <td>1028599.0</td>
      <td>288334.0</td>
      <td>0</td>
      <td>21316.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>22.11.2019</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 87 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Filter-the-dataframe">
<h1>Filter the dataframe<a class="headerlink" href="#Filter-the-dataframe" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Filter-the-dataframe-with-.query-method">
<h2>Filter the dataframe with <strong>.query</strong> method<a class="headerlink" href="#Filter-the-dataframe-with-.query-method" title="Permalink to this headline">¶</a></h2>
<p>Filter the dataframe by the elements from the list which is defined as a part of the query argument.</p>
<p><strong>REMEMBER SINGLE QUOTES WITHIN DOUBLE QUOTES.</strong></p>
<p><strong>NOTE: for columns with spaces in their name, you can use backtick quoting.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(wellbore_exploration_all
  .filter(items=[&quot;wellbore_name&quot;, &quot;well_type&quot;])
  .query(&quot;wellbore_name in [&#39;1/2-1&#39;, &#39;7324/10-1&#39;]&quot;)
)


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>EXPLORATION</td>
    </tr>
    <tr>
      <td>1917</td>
      <td>7324/10-1</td>
      <td>EXPLORATION</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Query-the-dataframe-by-multiple-conditions">
<h2>Query the dataframe by multiple conditions<a class="headerlink" href="#Query-the-dataframe-by-multiple-conditions" title="Permalink to this headline">¶</a></h2>
<p>Here we just added three conditions to filter the dataframe by. Note that I had to use **** withing the .query’s expression just to make it a bit more readable, i.e. every condition was in its own separate line.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(wellbore_exploration_all
   .filter(items=[&quot;drilling_operator&quot;, &quot;purpose&quot;, &quot;total_depth&quot;])
   .query(&#39;drilling_operator in [&quot;A/S Norske Shell&quot;, &quot;Statoil Petroleum AS&quot;] &amp; \
           purpose in &quot;WILDCAT&quot; &amp; \
           1000 &lt; total_depth &lt; 2000&#39;))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drilling_operator</th>
      <th>purpose</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>298</td>
      <td>A/S Norske Shell</td>
      <td>WILDCAT</td>
      <td>1971.0</td>
    </tr>
    <tr>
      <td>788</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1890.0</td>
    </tr>
    <tr>
      <td>1289</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1640.0</td>
    </tr>
    <tr>
      <td>1537</td>
      <td>A/S Norske Shell</td>
      <td>WILDCAT</td>
      <td>1920.0</td>
    </tr>
    <tr>
      <td>1831</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1033.0</td>
    </tr>
    <tr>
      <td>1850</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1594.0</td>
    </tr>
    <tr>
      <td>1853</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1780.0</td>
    </tr>
    <tr>
      <td>1860</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1855.0</td>
    </tr>
    <tr>
      <td>1898</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1500.0</td>
    </tr>
    <tr>
      <td>1901</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1540.0</td>
    </tr>
    <tr>
      <td>1907</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1090.0</td>
    </tr>
    <tr>
      <td>1916</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1100.0</td>
    </tr>
    <tr>
      <td>1919</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1210.0</td>
    </tr>
    <tr>
      <td>1921</td>
      <td>Statoil Petroleum AS</td>
      <td>WILDCAT</td>
      <td>1540.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Query-the-dataframe-by-a-predefined-list.">
<h2>Query the dataframe by a predefined list.<a class="headerlink" href="#Query-the-dataframe-by-a-predefined-list." title="Permalink to this headline">¶</a></h2>
<p>Here we have a list of top 10 operators based on the amount wells drilled on the Norwegian continental shelf. Since the data contains historical records you will see some old names for the recent companies.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>operators_top_10 = [&#39;Norsk Hydro Produksjon AS&#39;,
 &#39;Statoil Petroleum AS&#39;,
 &#39;Saga Petroleum ASA&#39;,
 &#39;Lundin Norway AS&#39;,
 &#39;Esso Exploration and Production Norway A/S&#39;,
 &#39;A/S Norske Shell&#39;,
 &#39;Elf Petroleum Norge AS&#39;,
 &#39;Phillips Petroleum Company Norway&#39;,
 &#39;Statoil ASA (old)&#39;]
</pre></div>
</div>
</div>
<p>You can refer to variables in the environment by prefixing them with an ‘&#64;’ character like for example <strong>&#64;operators_top_10</strong>, i.e.</p>
<p>.query(“drilling_operator == <strong>&#64;operators_top_10</strong>”)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(wellbore_exploration_all
    .filter(items=[&#39;drilling_operator&#39;, &quot;drilling_days&quot;])
    .query(&quot;drilling_operator == @operators_top_10&quot;)
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drilling_operator</th>
      <th>drilling_days</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>A/S Norske Shell</td>
      <td>129</td>
    </tr>
    <tr>
      <td>3</td>
      <td>A/S Norske Shell</td>
      <td>75</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Elf Petroleum Norge AS</td>
      <td>216</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Elf Petroleum Norge AS</td>
      <td>83</td>
    </tr>
    <tr>
      <td>6</td>
      <td>A/S Norske Shell</td>
      <td>134</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>1907</td>
      <td>Statoil Petroleum AS</td>
      <td>19</td>
    </tr>
    <tr>
      <td>1916</td>
      <td>Statoil Petroleum AS</td>
      <td>11</td>
    </tr>
    <tr>
      <td>1918</td>
      <td>Statoil Petroleum AS</td>
      <td>29</td>
    </tr>
    <tr>
      <td>1919</td>
      <td>Statoil Petroleum AS</td>
      <td>16</td>
    </tr>
    <tr>
      <td>1921</td>
      <td>Statoil Petroleum AS</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
<p>948 rows × 2 columns</p>
</div></div>
</div>
</div>
</div>
<div class="section" id="Sort-the-dataframe">
<h1>Sort the dataframe<a class="headerlink" href="#Sort-the-dataframe" title="Permalink to this headline">¶</a></h1>
<p>Sort based on values in a single column:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(wellbore_exploration_all
    .filter(items=[&#39;drilling_operator&#39;, &quot;drilling_days&quot;, &quot;total_depth&quot;])
    .sort_values(by=&quot;total_depth&quot;, ascending=False)
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drilling_operator</th>
      <th>drilling_days</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1257</td>
      <td>Statoil ASA (old)</td>
      <td>49</td>
      <td>7928.0</td>
    </tr>
    <tr>
      <td>1276</td>
      <td>Statoil Petroleum AS</td>
      <td>32</td>
      <td>7811.0</td>
    </tr>
    <tr>
      <td>1260</td>
      <td>Statoil ASA (old)</td>
      <td>27</td>
      <td>7725.0</td>
    </tr>
    <tr>
      <td>1258</td>
      <td>Statoil ASA (old)</td>
      <td>67</td>
      <td>7594.0</td>
    </tr>
    <tr>
      <td>293</td>
      <td>Den norske stats oljeselskap a.s</td>
      <td>203</td>
      <td>7584.0</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>1332</td>
      <td>Equinor Energy AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>702</td>
      <td>ConocoPhillips Skandinavia AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>295</td>
      <td>Talisman Energy Norge AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>1757</td>
      <td>Norsk Hydro Produksjon AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>281</td>
      <td>Spirit Energy Norway AS</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1922 rows × 3 columns</p>
</div></div>
</div>
<p>Sort based on values in multiple columns:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(wellbore_exploration_all
    .filter(items=[&#39;drilling_operator&#39;, &quot;drilling_days&quot;, &quot;total_depth&quot;])
    .sort_values(by=[&quot;drilling_operator&quot;, &quot;drilling_days&quot;], ascending=False)
)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drilling_operator</th>
      <th>drilling_days</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1478</td>
      <td>Wintershall Norge ASA</td>
      <td>112</td>
      <td>4177.0</td>
    </tr>
    <tr>
      <td>1447</td>
      <td>Wintershall Norge ASA</td>
      <td>87</td>
      <td>4216.0</td>
    </tr>
    <tr>
      <td>1368</td>
      <td>Wintershall Norge ASA</td>
      <td>66</td>
      <td>3585.0</td>
    </tr>
    <tr>
      <td>1366</td>
      <td>Wintershall Norge ASA</td>
      <td>55</td>
      <td>2807.0</td>
    </tr>
    <tr>
      <td>1317</td>
      <td>Wintershall Norge ASA</td>
      <td>47</td>
      <td>3006.0</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>1538</td>
      <td>A/S Norske Shell</td>
      <td>13</td>
      <td>1800.0</td>
    </tr>
    <tr>
      <td>1534</td>
      <td>A/S Norske Shell</td>
      <td>12</td>
      <td>1804.0</td>
    </tr>
    <tr>
      <td>1546</td>
      <td>A/S Norske Shell</td>
      <td>10</td>
      <td>1805.0</td>
    </tr>
    <tr>
      <td>961</td>
      <td>A/S Norske Shell</td>
      <td>9</td>
      <td>5035.0</td>
    </tr>
    <tr>
      <td>1462</td>
      <td>A/S Norske Shell</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1922 rows × 3 columns</p>
</div></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="cleaning_column_names.html" class="btn btn-neutral float-left" title="Load tabular data from csv" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Kristijan Bakaric

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>