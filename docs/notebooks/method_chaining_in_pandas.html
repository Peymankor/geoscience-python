

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How method chaining in pandas is and can be super effective &mdash; Geoscience with Python 2019 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Cleaning" href="data_cleaning_dataframes.html" />
    <link rel="prev" title="Quick introduction on the approach" href="quick_introduction.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Geoscience with Python
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../additional/welcome.html">Welcome!!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional/tips_and_tricks.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional/tips_and_tricks.html#jupyter-notebook-keyboard-shortcuts">Jupyter Notebook keyboard shortcuts</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_introduction.html">Quick introduction on the approach</a></li>
</ul>
<p class="caption"><span class="caption-text">Method chaining concept:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">How method chaining in pandas is and can be super effective</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Readable-and-understandable-code---chaining">Readable and understandable code - chaining</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#How-to-track-a-changing-of-the-dataframe-shape-along-the-chain?">How to track a changing of the dataframe shape along the chain?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Data Cleaning:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_cleaning_dataframes.html">Data Cleaning</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Visualization:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_visualisation_dataframes.html">Data Visualization - Dataframes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Geoscience with Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>How method chaining in pandas is and can be super effective</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/method_chaining_in_pandas.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="How-method-chaining-in-pandas-is-and-can-be-super-effective">
<h1>How method chaining in pandas is and can be super effective<a class="headerlink" href="#How-method-chaining-in-pandas-is-and-can-be-super-effective" title="Permalink to this headline">¶</a></h1>
<p>Method chaining is a programmatic style of invoking multiple method calls sequentially with each call performing an action on the same object and returning it.</p>
<p>It eliminates the cognitive burden of naming variables at each intermediate step.</p>
<p>Fluent Interface, a method of creating object-oriented API relies on method cascading (aka method chaining).</p>
<p>Method chaining substantially increases the readability of the code.</p>
<p>It is a top down approach.</p>
<div class="section" id="Readable-and-understandable-code---chaining">
<h2>Readable and understandable code - chaining<a class="headerlink" href="#Readable-and-understandable-code---chaining" title="Permalink to this headline">¶</a></h2>
<p>I will always try to avoid the following two ways of writing code:</p>
<p><strong>1) MUTLIPLE OBJECT OPTION</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eat</span><span class="p">(</span>

    <span class="nb">slice</span><span class="p">(</span>

        <span class="n">bake</span><span class="p">(</span>

            <span class="n">put</span><span class="p">(</span>
                <span class="n">pour</span><span class="p">(</span>

                    <span class="n">mix</span><span class="p">(</span><span class="n">ingredients</span><span class="p">),</span>

                    <span class="n">into</span><span class="o">=</span><span class="n">baking_form</span><span class="p">),</span>

                    <span class="n">into</span><span class="o">=</span><span class="n">oven</span><span class="p">),</span>

                <span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>

            <span class="n">pieces</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
        <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This first option is considered a “nested” option such that functions are nested within one another. Historically, this has been the traditional way of integrating code; however, it becomes extremely difficult to read what exactly the code is doing and it also becomes easier to make mistakes when making updates to your code. Although not in violation of the DRY principle1, it definitely violates the basic principle of readability and clarity, which makes communication of your analysis more
difficult. To make things more readable, people often move to the following approach…</p>
<p><strong>2) NESTED OPTION</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">it</span> <span class="o">=</span> <span class="n">mix</span><span class="p">(</span><span class="n">ingredients</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">pour</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">into</span><span class="o">=</span><span class="n">baking_form</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">put</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">into</span><span class="o">=</span><span class="n">oven</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">bake</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">pieces</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">it</span> <span class="o">=</span> <span class="n">eat</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This second option helps in making the data wrangling steps more explicit and obvious but definitely violates the DRY principle. By sequencing multiple functions in this way you are likely saving multiple outputs that are not very informative to you or others; rather, the only reason you save them is to insert them into the next function to eventually get the final output you desire. This inevitably creates unnecessary copies and wrecks havoc on properly managing your objects…basically it
results in a global environment charlie foxtrot!</p>
<p><strong>I WILL INSIST ON METHODS CHAINING (if and when python and pandas allows you)</strong></p>
<p>To provide the same readability (or even better), we can use chaining of methods to string these arguments together without unnecessary object creation…</p>
<p>The point of the chain is to help you write code in a way that is easier to read and understand. It is powerful tool for clearly expressing a sequence of multiple operations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ingredients</span>

    <span class="o">.</span><span class="n">mix</span><span class="p">()</span>

    <span class="o">.</span><span class="n">pour</span><span class="p">(</span><span class="n">into</span><span class="o">=</span><span class="n">baking_form</span><span class="p">)</span>

    <span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">into</span><span class="o">=</span><span class="n">oven</span><span class="p">)</span>

    <span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

    <span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">pieces</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

    <span class="o">.</span><span class="n">ear</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">janitor</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://factpages.npd.no/ReportServer_npdpublic?/FactPages/TableView/wellbore_exploration_all&amp;rs:Command=Render&amp;rc:Toolbar=false&amp;rc:Parameters=f&amp;rs:Format=CSV&amp;Top100=false&amp;IpAddress=82.102.27.246&amp;CultureCode=en&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># initial column name cleaning step</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;wlb&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;fld&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;fcl&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">clean_names</span><span class="p">(</span><span class="n">case_type</span><span class="o">=</span><span class="s2">&quot;snake&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>production_licence</th>
      <th>purpose</th>
      <th>status</th>
      <th>content</th>
      <th>well_type</th>
      <th>sub_sea</th>
      <th>entry_date</th>
      <th>...</th>
      <th>npdid_wellbore</th>
      <th>dsc_npdid_discovery</th>
      <th>npdid_field</th>
      <th>npdid_facility_drilling</th>
      <th>npdid_wellbore_reclass</th>
      <th>prl_npdid_production_licence</th>
      <th>npdid_site_survey</th>
      <th>date_updated</th>
      <th>date_updated_max</th>
      <th>datesync_npd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1/2-1</td>
      <td>1/2-1</td>
      <td>Phillips Petroleum Norsk AS</td>
      <td>143</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>20.03.1989</td>
      <td>...</td>
      <td>1382</td>
      <td>43814.0</td>
      <td>3437650.0</td>
      <td>296245.0</td>
      <td>0</td>
      <td>21956.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1/2-2</td>
      <td>1/2-2</td>
      <td>Paladin Resources Norge AS</td>
      <td>143 CS</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL SHOWS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.12.2005</td>
      <td>...</td>
      <td>5192</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>278245.0</td>
      <td>0</td>
      <td>2424919.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1/3-1</td>
      <td>1/3-1</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>GAS</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>06.07.1968</td>
      <td>...</td>
      <td>154</td>
      <td>43820.0</td>
      <td>NaN</td>
      <td>288604.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1/3-2</td>
      <td>1/3-2</td>
      <td>A/S Norske Shell</td>
      <td>011</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>DRY</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>14.05.1969</td>
      <td>...</td>
      <td>165</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>288847.0</td>
      <td>0</td>
      <td>20844.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1/3-3</td>
      <td>1/3-3</td>
      <td>Elf Petroleum Norge AS</td>
      <td>065</td>
      <td>WILDCAT</td>
      <td>P&amp;A</td>
      <td>OIL</td>
      <td>EXPLORATION</td>
      <td>NO</td>
      <td>22.08.1982</td>
      <td>...</td>
      <td>87</td>
      <td>43826.0</td>
      <td>1028599.0</td>
      <td>288334.0</td>
      <td>0</td>
      <td>21316.0</td>
      <td>NaN</td>
      <td>03.10.2019</td>
      <td>03.10.2019</td>
      <td>19.11.2019</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 87 columns</p>
</div></div>
</div>
<p>Pandas doesn’t have a comprehensible list of methods to use in method chaining. But to make up for it, Pandas introduced Pipe function starting from version 0.16.2. Pipe enables user-defined methods in method chains.</p>
<p>With the introduction of pipe, you can almost write anything in a method chain which begets the question, How much chaining is too much?. This is an entirely subjective question and must be left to the discretion of the programmer. Most people find the sweet spot to be around 7 or 8 methods in a single chain. I don’t use any hard limits on the number of methods in a chain. Instead, I try to represent a single coherent thought in a single method chain.</p>
<p>Some of the critics of method chaining accuse it of increasing code readability at the cost of making debugging tricky, which is true. Imagine a chain that’s ten methods long that you are debugging after a month. The data frame structure or the column names have changed since then and now your chain starts throwing errors. Its impossible to now debug through the chain and see the changes it makes to the data frame as you move along the chain, albeit you can easily find which method call is
breaking the code. This needs to be addressed before starting to use long method chains in production or in notebooks.</p>
<div class="section" id="How-to-track-a-changing-of-the-dataframe-shape-along-the-chain?">
<h3>How to track a changing of the dataframe shape along the chain?<a class="headerlink" href="#How-to-track-a-changing-of-the-dataframe-shape-along-the-chain?" title="Permalink to this headline">¶</a></h3>
<p>Two things to note in this function are the fn argument that can take in a lambda function and display function call. Lambda function lends flexibility and the display function call makes the display of data frames and plots pretty in a Jupyter lab or a notebook setting.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">csnap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Custom Help function to print things in method chaining.</span>
<span class="sd">        Returns back the df to further use in chaining.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">fn</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">df</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check the dataframe shape</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wellbore_name&quot;</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">,</span> <span class="s2">&quot;drilling_operator&quot;</span><span class="p">,</span> <span class="s2">&quot;water_depth&quot;</span><span class="p">,</span> <span class="s2">&quot;total_depth&quot;</span><span class="p">])</span> <span class="c1"># select only 5 columns</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check the dataframe shape</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;water_depth &gt;= 1000&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span> <span class="c1"># check the dataframe shape</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(1921, 87)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(1921, 5)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(30, 5)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wellbore_name</th>
      <th>well</th>
      <th>drilling_operator</th>
      <th>water_depth</th>
      <th>total_depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1393</td>
      <td>6302/6-1</td>
      <td>6302/6-1</td>
      <td>Statoil ASA (old)</td>
      <td>1261.0</td>
      <td>4234.0</td>
    </tr>
    <tr>
      <td>1394</td>
      <td>6304/3-1</td>
      <td>6304/3-1</td>
      <td>A/S Norske Shell</td>
      <td>1235.3</td>
      <td>3642.0</td>
    </tr>
    <tr>
      <td>1396</td>
      <td>6305/4-1</td>
      <td>6305/4-1</td>
      <td>Norsk Hydro Produksjon AS</td>
      <td>1002.0</td>
      <td>2975.0</td>
    </tr>
    <tr>
      <td>1397</td>
      <td>6305/4-2 S</td>
      <td>6305/4-2</td>
      <td>A/S Norske Shell</td>
      <td>1086.0</td>
      <td>2985.0</td>
    </tr>
    <tr>
      <td>1413</td>
      <td>6403/6-1</td>
      <td>6403/6-1</td>
      <td>Statoil ASA (old)</td>
      <td>1721.0</td>
      <td>4120.0</td>
    </tr>
    <tr>
      <td>1414</td>
      <td>6403/10-1</td>
      <td>6403/10-1</td>
      <td>Norsk Hydro Produksjon AS</td>
      <td>1717.0</td>
      <td>3400.0</td>
    </tr>
    <tr>
      <td>1415</td>
      <td>6404/11-1</td>
      <td>6404/11-1</td>
      <td>BP Amoco Norge AS</td>
      <td>1495.0</td>
      <td>3650.0</td>
    </tr>
    <tr>
      <td>1416</td>
      <td>6405/7-1</td>
      <td>6405/7-1</td>
      <td>Statoil ASA (old)</td>
      <td>1206.0</td>
      <td>4300.0</td>
    </tr>
    <tr>
      <td>1550</td>
      <td>6504/5-1 S</td>
      <td>6504/5-1</td>
      <td>Eni Norge AS</td>
      <td>1190.0</td>
      <td>4193.0</td>
    </tr>
    <tr>
      <td>1675</td>
      <td>6603/5-1 S</td>
      <td>6603/5-1</td>
      <td>A/S Norske Shell</td>
      <td>1452.0</td>
      <td>5254.0</td>
    </tr>
    <tr>
      <td>1676</td>
      <td>6603/12-1</td>
      <td>6603/12-1</td>
      <td>A/S Norske Shell</td>
      <td>1376.0</td>
      <td>3830.0</td>
    </tr>
    <tr>
      <td>1677</td>
      <td>6604/2-1</td>
      <td>6604/2-1</td>
      <td>BG Norge AS</td>
      <td>1262.0</td>
      <td>3551.0</td>
    </tr>
    <tr>
      <td>1678</td>
      <td>6604/5-1</td>
      <td>6604/5-1</td>
      <td>Wintershall Norge AS</td>
      <td>1219.0</td>
      <td>3858.0</td>
    </tr>
    <tr>
      <td>1679</td>
      <td>6604/10-1</td>
      <td>6604/10-1</td>
      <td>A/S Norske Shell</td>
      <td>1354.0</td>
      <td>3715.0</td>
    </tr>
    <tr>
      <td>1680</td>
      <td>6605/1-1</td>
      <td>6605/1-1</td>
      <td>StatoilHydro ASA</td>
      <td>1157.0</td>
      <td>3947.0</td>
    </tr>
    <tr>
      <td>1742</td>
      <td>6704/12-1</td>
      <td>6704/12-1</td>
      <td>Saga Petroleum ASA</td>
      <td>1352.0</td>
      <td>4103.0</td>
    </tr>
    <tr>
      <td>1743</td>
      <td>6705/7-1</td>
      <td>6705/7-1</td>
      <td>Repsol Norge AS</td>
      <td>1404.0</td>
      <td>3290.0</td>
    </tr>
    <tr>
      <td>1744</td>
      <td>6705/10-1</td>
      <td>6705/10-1</td>
      <td>StatoilHydro Petroleum AS</td>
      <td>1335.0</td>
      <td>3775.0</td>
    </tr>
    <tr>
      <td>1745</td>
      <td>6706/6-1</td>
      <td>6706/6-1</td>
      <td>Esso Exploration and Production Norway A/S</td>
      <td>1298.0</td>
      <td>3451.0</td>
    </tr>
    <tr>
      <td>1746</td>
      <td>6706/6-2 S</td>
      <td>6706/6-2</td>
      <td>Wintershall Norge AS</td>
      <td>1214.0</td>
      <td>3916.0</td>
    </tr>
    <tr>
      <td>1747</td>
      <td>6706/11-1</td>
      <td>6706/11-1</td>
      <td>Den norske stats oljeselskap a.s</td>
      <td>1238.0</td>
      <td>4317.0</td>
    </tr>
    <tr>
      <td>1748</td>
      <td>6706/11-2</td>
      <td>6706/11-2</td>
      <td>Statoil Petroleum AS</td>
      <td>1272.0</td>
      <td>2596.0</td>
    </tr>
    <tr>
      <td>1749</td>
      <td>6706/12-1</td>
      <td>6706/12-1</td>
      <td>StatoilHydro ASA</td>
      <td>1262.0</td>
      <td>3950.0</td>
    </tr>
    <tr>
      <td>1750</td>
      <td>6706/12-2</td>
      <td>6706/12-2</td>
      <td>Statoil Petroleum AS</td>
      <td>1312.0</td>
      <td>2754.0</td>
    </tr>
    <tr>
      <td>1751</td>
      <td>6706/12-3</td>
      <td>6706/12-3</td>
      <td>Statoil Petroleum AS</td>
      <td>1287.0</td>
      <td>3336.0</td>
    </tr>
    <tr>
      <td>1752</td>
      <td>6707/10-1</td>
      <td>6707/10-1</td>
      <td>BP Norway Limited U.A.</td>
      <td>1274.0</td>
      <td>5039.0</td>
    </tr>
    <tr>
      <td>1753</td>
      <td>6707/10-2 A</td>
      <td>6707/10-2</td>
      <td>StatoilHydro ASA</td>
      <td>1248.0</td>
      <td>4850.0</td>
    </tr>
    <tr>
      <td>1754</td>
      <td>6707/10-2 S</td>
      <td>6707/10-2</td>
      <td>StatoilHydro ASA</td>
      <td>1248.0</td>
      <td>3365.0</td>
    </tr>
    <tr>
      <td>1755</td>
      <td>6707/10-3 S</td>
      <td>6707/10-3</td>
      <td>Centrica Resources (Norge) AS</td>
      <td>1421.0</td>
      <td>4789.0</td>
    </tr>
    <tr>
      <td>1758</td>
      <td>7016/2-1</td>
      <td>7016/2-1</td>
      <td>Eni Norge AS</td>
      <td>1366.0</td>
      <td>4061.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span>
    <span class="n">wine</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color_intensity&quot;</span><span class="p">:</span> <span class="s2">&quot;ci&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">color_filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">hue</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">ci</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;alcohol &gt; 14&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;alcohol&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;alcohol&quot;</span><span class="p">,</span> <span class="s2">&quot;ci&quot;</span><span class="p">,</span> <span class="s2">&quot;hue&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">csnap</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data_cleaning_dataframes.html" class="btn btn-neutral float-right" title="Data Cleaning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quick_introduction.html" class="btn btn-neutral float-left" title="Quick introduction on the approach" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Kristijan Bakaric

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>